<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Manager - ClickDescubra 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .status {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .status-icon.loading {
            background: #ffc107;
        }

        .status-icon.success {
            background: #28a745;
        }

        .status-icon.error {
            background: #dc3545;
        }

        .main-content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4facfe;
        }

        .question-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4facfe;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .option-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-input input[type="radio"] {
            width: auto;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(238, 90, 82, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(64, 192, 87, 0.4);
        }

        .questions-list {
            display: grid;
            gap: 20px;
        }

        .question-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
        }

        .question-card:hover {
            border-color: #4facfe;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .question-header {
            display: flex;
            justify-content: between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .question-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            flex-grow: 1;
            margin-right: 15px;
        }

        .question-meta {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
        }

        .question-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .option {
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .option.correct {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .option.incorrect {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            color: #495057;
        }

        .question-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            opacity: 0.9;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>🎯 Quiz Manager</h1>
            <p>Gerencie as perguntas do ClickDescubra 2025</p>
        </div>

        <div class="status">
            <div class="status-item">
                <div class="status-icon loading" id="statusIcon"></div>
                <span id="statusText">Carregando...</span>
            </div>
            <button class="btn btn-success" onclick="loadQuestions()">
                🔄 Recarregar
            </button>
        </div>

        <div class="main-content">
            <!-- Stats -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalQuestions">0</div>
                    <div class="stat-label">Total de Perguntas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="categoriesCount">0</div>
                    <div class="stat-label">Categorias</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgTime">0s</div>
                    <div class="stat-label">Tempo Médio</div>
                </div>
            </div>

            <!-- Alert Messages -->
            <div id="alertContainer"></div>

            <!-- Add Question Form -->
            <div class="section">
                <h2 class="section-title">➕ Adicionar Nova Pergunta</h2>
                <div class="question-form">
                    <div class="form-group">
                        <label for="questionText">Pergunta:</label>
                        <textarea id="questionText" placeholder="Digite sua pergunta aqui..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Opções de Resposta:</label>
                        <div class="options-grid">
                            <div class="option-input">
                                <input type="radio" name="correctOption" value="0" id="correct0">
                                <input type="text" id="option0" placeholder="Opção 1">
                            </div>
                            <div class="option-input">
                                <input type="radio" name="correctOption" value="1" id="correct1">
                                <input type="text" id="option1" placeholder="Opção 2">
                            </div>
                            <div class="option-input">
                                <input type="radio" name="correctOption" value="2" id="correct2">
                                <input type="text" id="option2" placeholder="Opção 3">
                            </div>
                            <div class="option-input">
                                <input type="radio" name="correctOption" value="3" id="correct3">
                                <input type="text" id="option3" placeholder="Opção 4">
                            </div>
                        </div>
                        <small style="color: #666;">Selecione o botão de rádio da resposta correta</small>
                    </div>

                    <div class="form-group">
                        <label for="category">Categoria:</label>
                        <input type="text" id="category" placeholder="Ex: Geografia, História, Ciências...">
                    </div>

                    <div class="form-group">
                        <label for="timeSeconds">Tempo (segundos):</label>
                        <input type="number" id="timeSeconds" value="20" min="5" max="60">
                    </div>

                    <button class="btn btn-primary" onclick="addQuestion()">
                        ➕ Adicionar Pergunta
                    </button>
                </div>
            </div>

            <!-- Questions List -->
            <div class="section">
                <h2 class="section-title">📝 Perguntas Existentes</h2>
                <div id="questionsList" class="questions-list">
                    <!-- Questions will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_CONFIG = {
            binId: '68e7598543b1c97be95fbb4d',
            apiKey: '$2a$10$Uu3NdRpmfPSc0b2MNV0PY.mKluWPCevjK7ioHlXr4AlMca/HC2V9y',
            baseUrl: 'https://api.jsonbin.io/v3/b'
        };

        let quizData = null;

        // Load questions on page load
        document.addEventListener('DOMContentLoaded', function () {
            loadQuestions();
        });

        async function loadQuestions() {
            setStatus('loading', 'Carregando perguntas...');

            try {
                const response = await fetch(`${API_CONFIG.baseUrl}/${API_CONFIG.binId}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': API_CONFIG.apiKey,
                        'X-Bin-Meta': 'false'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                quizData = await response.json();
                setStatus('success', `✅ ${quizData.questions.length} perguntas carregadas`);

                displayQuestions();
                updateStats();

            } catch (error) {
                console.error('Error loading questions:', error);
                setStatus('error', '❌ Erro ao carregar perguntas');
                showAlert('Erro ao carregar perguntas: ' + error.message, 'error');
            }
        }

        async function saveQuestions() {
            setStatus('loading', 'Salvando alterações...');

            try {
                const response = await fetch(`${API_CONFIG.baseUrl}/${API_CONFIG.binId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': API_CONFIG.apiKey
                    },
                    body: JSON.stringify(quizData)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                setStatus('success', '✅ Alterações salvas com sucesso');
                showAlert('Perguntas salvas com sucesso!', 'success');

            } catch (error) {
                console.error('Error saving questions:', error);
                setStatus('error', '❌ Erro ao salvar');
                showAlert('Erro ao salvar: ' + error.message, 'error');
            }
        }

        function addQuestion() {
            const questionText = document.getElementById('questionText').value.trim();
            const option0 = document.getElementById('option0').value.trim();
            const option1 = document.getElementById('option1').value.trim();
            const option2 = document.getElementById('option2').value.trim();
            const option3 = document.getElementById('option3').value.trim();
            const category = document.getElementById('category').value.trim();
            const timeSeconds = parseInt(document.getElementById('timeSeconds').value);
            const correctOption = document.querySelector('input[name="correctOption"]:checked');

            // Validation
            if (!questionText) {
                showAlert('Por favor, digite a pergunta.', 'error');
                return;
            }

            if (!option0 || !option1 || !option2 || !option3) {
                showAlert('Por favor, preencha todas as 4 opções.', 'error');
                return;
            }

            if (!correctOption) {
                showAlert('Por favor, selecione a resposta correta.', 'error');
                return;
            }

            if (!category) {
                showAlert('Por favor, digite a categoria.', 'error');
                return;
            }

            if (!quizData) {
                quizData = {
                    title: "Quiz ClickDescubra 2025",
                    questions: []
                };
            }

            // Create new question
            const newQuestion = {
                id: 'q' + (Date.now()),
                question: questionText,
                options: [option0, option1, option2, option3],
                correctIndex: parseInt(correctOption.value),
                timeSeconds: timeSeconds,
                category: category
            };

            quizData.questions.push(newQuestion);

            // Clear form
            document.getElementById('questionText').value = '';
            document.getElementById('option0').value = '';
            document.getElementById('option1').value = '';
            document.getElementById('option2').value = '';
            document.getElementById('option3').value = '';
            document.getElementById('category').value = '';
            document.getElementById('timeSeconds').value = '20';
            document.querySelector('input[name="correctOption"]:checked').checked = false;

            // Save and refresh
            saveQuestions().then(() => {
                displayQuestions();
                updateStats();
            });

            showAlert('Pergunta adicionada com sucesso!', 'success');
        }

        function deleteQuestion(questionId) {
            if (!confirm('Tem certeza que deseja excluir esta pergunta?')) {
                return;
            }

            if (quizData && quizData.questions) {
                quizData.questions = quizData.questions.filter(q => q.id !== questionId);

                saveQuestions().then(() => {
                    displayQuestions();
                    updateStats();
                });

                showAlert('Pergunta excluída com sucesso!', 'success');
            }
        }

        function displayQuestions() {
            const container = document.getElementById('questionsList');

            if (!quizData || !quizData.questions || quizData.questions.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">Nenhuma pergunta encontrada.</p>';
                return;
            }

            container.innerHTML = quizData.questions.map(question => `
                <div class="question-card">
                    <div class="question-header">
                        <div class="question-title">${question.question}</div>
                    </div>
                    <div class="question-meta">
                        <strong>Categoria:</strong> ${question.category} | 
                        <strong>Tempo:</strong> ${question.timeSeconds}s |
                        <strong>ID:</strong> ${question.id}
                    </div>
                    <div class="question-options">
                        ${question.options.map((option, index) => `
                            <div class="option ${index === question.correctIndex ? 'correct' : 'incorrect'}">
                                ${index === question.correctIndex ? '✓' : '○'} ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div class="question-actions">
                        <button class="btn btn-danger" onclick="deleteQuestion('${question.id}')">
                            🗑️ Excluir
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateStats() {
            if (!quizData || !quizData.questions) {
                document.getElementById('totalQuestions').textContent = '0';
                document.getElementById('categoriesCount').textContent = '0';
                document.getElementById('avgTime').textContent = '0s';
                return;
            }

            const questions = quizData.questions;
            const totalQuestions = questions.length;
            const categories = new Set(questions.map(q => q.category)).size;
            const avgTime = questions.length > 0 ?
                Math.round(questions.reduce((sum, q) => sum + q.timeSeconds, 0) / questions.length) : 0;

            document.getElementById('totalQuestions').textContent = totalQuestions;
            document.getElementById('categoriesCount').textContent = categories;
            document.getElementById('avgTime').textContent = avgTime + 's';
        }

        function setStatus(type, message) {
            const icon = document.getElementById('statusIcon');
            const text = document.getElementById('statusText');

            icon.className = `status-icon ${type}`;
            text.textContent = message;
        }

        function showAlert(message, type) {
            const container = document.getElementById('alertContainer');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;

            container.innerHTML = '';
            container.appendChild(alertDiv);

            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }
    </script>
</body>

</html>